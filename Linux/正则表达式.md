# 正则表达式(regular expression)

#### 元字符

---

> $ ( ) * + . ? [ \  ^ { |

```
^
开始位置，中括号中对字符集求反。

$
字符串结尾的位置。

( )
标记子表达式的开始和结束。可以捕获子表达式以供以后使用。

*
零次或多次匹配前面的字符或子表达式。

+
一次或多次匹配前面的字符或子表达式。

.
匹配除换行符 \n 之外的任何单个字符。

[ ]
标记中括号表达式的开始。

?
零次或一次匹配前面的字符或子表达式，或指示“非贪心”限定符。

\
将下一字符标记为特殊字符、文本、反向引用或八进制转义符。例如，字符 n 匹配字符 n。\n 匹配换行符。

/
表示文本正则表达式的开始或结束。

{ }
标记限定符表达式的开始。

|
指出在两个项之间进行选择。
```

#### 匹配与限制

---

> 匹配：匹配怎样的数据：单个、一类
>
> 限制：找到数据的规律后如何通过限制手段提取想要的数据：量词、边界、逻辑符、定位

##### 匹配|单个

> 1.直接使用相应字符
>
> 2.\转义字符



##### 匹配|一类

> 1.[]里面的就是一类字符
>
> 2.预定义字符

1. []:

   ```
   - [0-9]、[^0-9]
   - [a-z]、[a-d[m-p]]、[a-z&&[def]]...
   ```

2. 预定义字符：大写代表非

   ```
   - \d：数字：[0-9]
   - \s：空白字符包括\t、\n、\f、\r
   - \w：单词：[a-zA-Z_0-9]注意是：字母、数字和下划线
   ```

##### 限制|量词

> 1.匹配一个或者是一类都是匹配一个字符，因此需要数量限制
>
> 2.量词：个数、greedy(贪心)、reluctant(懒惰)?、possessive(占有)+

```
1.个数：{10}10次、{10,}至少十次、{10,20}至少10次，不超过20次
*零或多
+一或多、代表占有类型
？零或一、代表懒惰
2.greedy贪心：匹配最长，读取字符串从后向前匹配
3.reluctant懒惰：匹配最短，从前往后匹配
4.possessive占有：完全匹配，必须完全一样
例子：匹配：12a34abc 
greedy(贪心)：格式：1.*a 结果：12a34a
reluctant(懒惰)?：格式：1.*?a 结果：12a
possessive(占有)+：格式：1.*+a 结果：无 ？？？？？？只能匹配开头为1，结尾为a的

```

##### 限制|定位

> 1.确定字符的所处位子

```
^
行的开头
$
行的结尾
\b
单词边界
\B
非单词边界
\A
输入的开头
\G
上一个匹配的结尾
用得较多的为前三个，这里主要介绍\b
例子：匹配My cat is brown中的cat，但是不会匹配category或是bobcat
\\bcat\\b
```

##### 限制|逻辑符

> 常用的逻辑

```
XY
X  后跟 Y

X|Y
X  或 Y

(X)
X，作为捕获组
```

#### 回溯：前后一致

> 1.开头和结尾一致，开头的已经匹配好，结尾直接引用

```
使用"()"将要匹配的关键词包裹，可以有多个()
\1、\2、\3......可以在正则表达式里按照顺序引用()里面的已经匹配好的
$1、$2、$3......可以在脚本中替换()匹配的内容
1.例子：<H1>wellcome</H1> 
	   <H2>wellcome</H2> 
	   <H2>wellcome</H3>  //错误格式
	   错误匹配：<H[1-6]>.*?</H[1-6]> //可能的结果：直接匹配<H1>到</H3>
	   正确匹配：<H[1-6]>.*?</H\1>  
```





#### 限制|向前向后

>1.向前向后
>
>2.向前向后取非

```
向前查找 ?= ，需要匹配的文本放在=的后面，并且匹配的文本在结果中将被剔除
例子：提取url
http:
https:
ftp:
匹配：.+(?=:)//:将被剔除，对比.+(:)可知

向后查找 ?<=,需要匹配的文本放在=的后面,并且匹配的文本在结果中将被剔除
例子：删除货币符号$，提取数字
cat:$1
dog:$2
匹配：(?<=\$)[0-9.]+
```



#### 例子

```
网址（URL）
[a-zA-z]+://[^\s]*

IP地址(IP Address)
((2[0-4]\d|25[0-5]|[01]?\d\d?)\.){3}(2[0-4]\d|25[0-5]|[01]?\d\d?)

电子邮件(Email)
\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*

QQ号码
[1-9]\d{4,}

HTML标记(包含内容或自闭合)
<(.*)(.*)>.*<\/\1>|<(.*) \/>

密码(由数字/大写字母/小写字母/标点符号组成，四种都必有，8位以上)
(?=^.{8,}$)(?=.*\d)(?=.*\W+)(?=.*[A-Z])(?=.*[a-z])(?!.*\n).*$

日期(年-月-日)
(\d{4}|\d{2})-((0?([1-9]))|(1[1|2]))-((0?[1-9])|([12]([1-9]))|(3[0|1]))

日期(月/日/年)
((0?[1-9]{1})|(1[1|2]))/(0?[1-9]|([12][1-9])|(3[0|1]))/(\d{4}|\d{2})

时间(小时:分钟, 24小时制)
((1|0?)[0-9]|2[0-3]):([0-5][0-9])

汉字(字符)
[\u4e00-\u9fa5]

中文及全角标点符号(字符)
[\u3000-\u301e\ufe10-\ufe19\ufe30-\ufe44\ufe50-\ufe6b\uff01-\uffee]

中国大陆固定电话号码
(\d{4}-|\d{3}-)?(\d{8}|\d{7})

中国大陆手机号码
1[356789]\d{9}

中国大陆邮政编码
[1-9]\d{5}

中国大陆身份证号(15位或18位)
\d{15}(\d\d[0-9xX])?

非负整数(正整数或零)
\d+

正整数
[0-9]*[1-9][0-9]*

负整数
-[0-9]*[1-9][0-9]*

整数
-?\d+

小数
(-?\d+)(\.\d+)?
```

